This thesis has presented a version of ZGC that offers the possibility of utilizing fragmented memory using free-lists. While this implementation has proved that it is possible, and evaluated some key metrics for its viability, there is a lot of work that has to be done in order to reach the full potential of this new relocation technique. In this section, I will propose some future work that could lead to improvements to my solution, and also some recommended future work that I think should be focused on before moving onward.

\subsection{Potential Future Work}
In the HotSpot VM, the current minimum size of an object is 16, which forces objects smaller than that to allocate more memory than they need. This causes internal fragmentation, which allocates more memory than the program actually needs. This is currently being worked on by another project at Oracle, in parallel to this thesis. The project is called \textit{Lilliput}, and proposes a change to HotSpot that would decrease the minimum size of objects to 8 Bytes instead of 16~\cite{todo:-lilliput-sno-fr√•n-joel-eller-casper}. This change would have an impact on the use of free-lists, since smaller allocations would allow the allocator to fit objects more tightly together. This could potentially decrease the fragmentation even further when using the free-list.

Another possibile path to take from here would be to look into the possibility of handling the age of objects on a per-object basis, such that the object itself can tell how old it is, and not base it on the age of the page that it is in. With the 16 Bytes minimum allocation size comes some metadata in a header, referred to as the \textit{markword} in HotSpot. This markword contains 4 bits of memory that ZGC currently does not make use of. 4 bits are able to represent $2^4 = 16$ different states, the same as the amount of different ages that objects can have in ZGC. Since the free-lists are being chosen as target locations based on the age of objects, they are currently not being utilized at their full potential. By allowing objects of different ages to be relocated into the same page, relocations would not have to worry about the presence of a free-list of the relocated object's age, instead only caring about whether any free-list exists at all.

\subsection{Recommended Future Work}
The implementation presented in this thesis has not changed the behaviour of how ZGC chooses its relocation set. The relocation set is chosen such that pages with small amounts of live objects are supposed to be evacuated, and that is how ZGC reclaims the fragmented memory in that page. This formula for choosing the relocation set is based on the fact that the the unused data in pages was not reachable, and could only be utilized by evacuating the entire page. The introduction of a free-list changes this assumption, and opens up the possibility of using the memory without evacuating the page. From the results of this thesis, we can see that the relocation set that is selected is not fit for this use, since the amount of memory represented by free-lists is about 20x as much as what is being utilized. By somehow predicting the size of the relocation set, and how much memory is being relocated for each age, free-lists can be constructed to match it better, to avoid spending as much time constructing free-lists that are never used.

Another possible change to the proposed solution in this thesis is to design a high-level allocator that can represent a free-list across multiple pages. In this thesis, the allocators are used on a per-page basis, and if an object fails to allocate an object, the page is deemed exhausted, and the allocation is done on another page. If the allocator tried to allocate a large object, the potential small objects that would have fit inside the page have also been ruled out after exhausting the page. By instead designing a higher level allocator that can represent a more complete free-list across multiple pages, it would be easier to find a spot to allocate large object without exhausting available free-list space for smaller objects. 

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
